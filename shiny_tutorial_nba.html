<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Learning Shiny with NBA data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}

.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://juliawrobel.com">Home</a>
</li>
<li>
  <a href="mailto:&lt;jw3134@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/julia-wrobel/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/jwrobel1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Learning Shiny with NBA data</h1>

</div>


<p>This Shiny tutorial was made for the R Ladies NYC meetup on May 8, 2018. Thanks again to the NBA New York office for agreeing to host!!</p>
<p>Shiny is RStudio’s framework introduced in 2012 for building interactive plots and web applications in <code>R</code>. By the end of this tutorial you should have some basic understanding of how Shiny works, and will make and deploy a Shiny app using data pulled from the <a href="http://stats.nba.com/">NBA stats API</a>. For inspiration and guidance I drew on Thanks to <a href="https://github.com/toddwschneider/ballr">Todd Schneider’s ballR app</a> inspiration and info on how to scrape the data. I highly recommend checking it out!</p>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>Before we begin, make sure you have the <code>shiny</code>, <code>plotly</code>, and <code>tidyverse</code> packages installed. I have created a template for our app, please <a href="Downloads/shiny_nba.zip">download</a> and unzip this as well.</p>
<pre class="r"><code>install.packages(c(&quot;shiny&quot;, &quot;plotly&quot;, &quot;tidyverse&quot;))</code></pre>
<p>Run an example of a simple shiny app to ensure the package is installed properly.</p>
<pre class="r"><code>library(shiny)
runExample(&quot;01_hello&quot;)</code></pre>
<p>A slider bar the allows you to change the number bins in the histogram shown.</p>
</div>
<div id="shiny-basics" class="section level2">
<h2>Shiny basics</h2>
<p>Each Shiny app has a <code>ui</code> and a <code>server</code> file, both of which we have to define. The <code>ui</code> defines a webpage that the user interacts with, it controls layout and appearance. The <code>server</code> file is a set of instructions your computer needs to build the app. <code>R</code> code is executed in the background, and output depends on the user input and this <code>R</code> code.</p>
<body>
<img src="images/what_is_shiny.png" style="width:75%">
<p>
<cite>image from</cite> <a href="https://deanattali.com/blog/building-shiny-apps-tutorial/" class="uri">https://deanattali.com/blog/building-shiny-apps-tutorial/</a>
</p>
</body>
<div id="the-shiny-framework" class="section level3">
<h3>The shiny framework</h3>
<p>All Shiny apps follow the same overall structure. <code>fluidPage()</code> controls the page layout for the ui. We define <code>server</code> as a function with arguments <code>input</code> and <code>output</code>.</p>
<pre class="r"><code>library(shiny)
ui &lt;- fluidPage()
server &lt;- function(input, output) {}
shinyApp(ui = ui, server = server)</code></pre>
<p>This template itself is a minimal Shiny app, try running the code. Copy this template into a new file called <code>app.R</code>, and save it in a new folder. After saving the file, you should see a <em>Run App</em> button at the top, indicating RStudio has recognized the file as a Shiny app.</p>
<p><img src="images/empty_app.png" style="width:100%"></p>
<p>Two ways to create Shiny apps:</p>
<ol style="list-style-type: decimal">
<li>Put both <code>ui</code> and <code>server</code> code into single file called <code>app.R</code>, ideal for simple apps. If you are using a single file, the file <strong>must</strong> be called <code>app.R</code> for the app to run.</li>
<li>Create separate <code>ui.R</code> and <code>server.R</code> files, ideal for more complicated apps.</li>
</ol>
<p>We will use the second approach for this tutorial. This is the preferable way to write apps unless your app is super simple. You can initialize a Shiny app using either approach right from RStudio:</p>
<p><img src="images/initiate_app1.png" style="width:100%"></p>
<p>Select <strong>Shiny Web App…</strong> and the following will pop up:</p>
<p><img src="images/initiate_app2.png" style="width:100%"></p>
<p>Select <strong>Multiple File</strong> to generate an app with separate <code>ui.R</code> and <code>server.R</code> files. I called my app “new_app” and stored it in a folder on my Desktop. To run the app you can do either of the following:</p>
<ol style="list-style-type: decimal">
<li>Open the <code>server.R</code> or <code>ui.R</code> file and click the Run App button.</li>
<li>Enter <code>shiny::runApp(&quot;~/Desktop/new_app/&quot;)</code> in your R console</li>
</ol>
<p>This is intended to show how a Shiny app can be initialized. For the rest of the tutorial we will be working with the <code>shiny_nba</code> file I provided.</p>
</div>
</div>
<div id="shiny-nba" class="section level2">
<h2>Shiny NBA</h2>
<p>If you haven’t already, download and unzip the <a href="Downloads/shiny_nba.zip">shiny_nba</a> folder provided. Open the .Rproj in the folder - this will open up RStudio and automatically set your working directory to this folder. Notice what’s in the folder:</p>
<ul>
<li>a <code>ui.R</code> file</li>
<li>a <code>server.R</code> file</li>
<li>a <code>nba_shots.RData</code> data object which contains the data for our app</li>
<li>a <code>helper.R</code> file with extra <code>R</code> code our app uses</li>
</ul>
<p>Try running the app. The app has a gray box on the side with dropdown menus that allows you to select a basketball player and season, and space on the right which is where a plot will go. This design is called <code>sidebarLayout()</code>. <a href="https://shiny.rstudio.com/articles/layout-guide.html">Many more flexible layouts are possible</a> as well, but we won’t cover them here.</p>
<div id="input-options" class="section level3">
<h3>Input options</h3>
<p>Input is defined through input functions called <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson3/">widgets</a>. These are text elements a user can interact with, like scroll bars or buttons. Our app uses <code>selectInput()</code> to create a drop-down menu, but many other input functions are available.</p>
<p><img src="images/widgets.png" style="width:75%"></p>
<p>All input functions have <code>inputId</code> and <code>label</code> as the first two arguments. The <code>inputId</code> is a string that the server side will use to access the value of the user input. For example, if <code>inputId = &quot;slider_widget&quot;</code> then on the server side you would use <code>input$slider_widget</code> to use its value.<code>label</code> is the title for the widget that will show up in the ui.</p>
<p><strong>Exercise</strong>: Try adding another widget to the sidebar.</p>
</div>
<div id="output-options-and-render-statements" class="section level3">
<h3>Output options and render statements</h3>
<p>Output options go in the <code>ui.R</code> file. The first argument of all output functions is “outputId”, which is used to identify each output and therefore must be unique for each output. Examples include <code>plotOutput()</code>, <code>textOutput()</code>, <code>tableOutput()</code>.</p>
<p><strong>Debugging tip</strong>: Make sure you have a comma between each input call and output call! Commas are needed between elements for the <code>ui</code> but not for the <code>server</code>.</p>
<p>Render statements go in the <code>server.R</code> file. They take user input from the widgets and execute a function. Examples including <code>renderTable()</code> to make tables, <code>renderText()</code> for text, and <code>renderPlot()</code> for certain plots (<em>works with plots made using base</em> <code>R</code> <em>or</em> <code>ggplot2</code> <em>but for plots made using</em> <code>plotly</code> <em>use</em> <code>renderPlotly()</code>).</p>
<p>Render statements are actually part of a larger and more flexible class of server-side functions called <strong>reactive expressions</strong> but we cover those later.</p>
<p>Run your <code>shiny_nba</code> app with the code below added.</p>
<pre class="r"><code>##### place in mainPanel of ui.R under plotOutput
textOutput(&quot;player_text&quot;),

# html tag
hr()

##### place in shinyServer of server.R
output$player_text&lt;- renderText({ 
  paste0(&quot;The player you have chosen is &quot;, input$player_choice)
})
</code></pre>
<p>The <code>renderPrint()</code> statement prints out the current selection from the player drop down menu. The <code>hr()</code> bit is a wrapper for the html tag <code>&lt;hr&gt;</code> and creates a horizontal line. There are a bunch of <a href="https://shiny.rstudio.com/articles/tag-glossary.html">awesome html wrapper functions</a> to help you customize your user interface.</p>
<p><strong>Debugging tip</strong>: Make sure you have a comma between each render call. <strong>Exercise: add another html tag to your UI</strong></p>
</div>
<div id="court-plot" class="section level3">
<h3>Court plot</h3>
<p>Let’s add a plot. We are going to plot the locations of all the attempted shots made by the selected NBA star. Add the following to your <code>server.R</code>. (**update wherever else you need to also, and mention it here! Also mention what help functions were used to create this plot. Maybe create plot in another function?)</p>
<p><strong>Debugging tip</strong>: if the non-Shiny version of your plot isn’t working, your Shiny version won’t either! Make sure to test complicated code before placing it in the Shiny framework.</p>
<p>flow:</p>
<ul>
<li>open new folder with nba app using that R project</li>
<li>run app to show what it looks like (should be empty frame)</li>
<li>add one tab, use this to mention that you can make the layout complicated with different ways to lay it out and lots of tabs. Links to resources for this at the bottom, but I’m not going to focus on it right now.</li>
<li>talk about widgets</li>
<li>put data in the right place</li>
<li>load libraries in the right place</li>
<li>build widget to access datanames, show what turns up in different scenarios</li>
<li>build ggplot object that shows cour data for the subject. Place ggplot object into the shiny framework and edit it to show how you incorporate it into shiny. Make sure it runs first!</li>
<li>add basketball icon to tab of this thing</li>
</ul>
</div>
<div id="adding-a-tab" class="section level3">
<h3>Adding a tab</h3>
</div>
<div id="plotly" class="section level3">
<h3>Plotly</h3>
</div>
</div>
<div id="reactive-vs.observer-stuff" class="section level2">
<h2>reactive vs. observer stuff</h2>
</div>
<div id="debugging-shiny" class="section level2">
<h2>Debugging shiny</h2>
</div>
<div id="deploying-your-app" class="section level2">
<h2>Deploying your app</h2>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<ul>
<li><p><a href="https://rmarkdown.rstudio.com/authoring_shiny.html">Embedding Shiny in Rmarkdown documents</a></p></li>
<li><p><a href="https://www.datacamp.com/courses/building-web-applications-in-r-with-shiny-case-studies">“Case Studies in Shiny”: Dean Attali’s short course at DataCamp</a></p></li>
<li><a href="http://www.showmeshiny.com/">Gallery of user-submitted Shiny apps</a></li>
<li><p><a href="http://shiny.rstudio.com/images/shiny-cheatsheet.pdf">Shiny cheatsheet</a></p></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
